<?php require('adminIncludes/header.php'); ?>
<h3>Kategori | Güncelle</h3>
<?php 
include('adminIncludes/config.php');
if($_POST){
    $id = $_GET["id"];
    $category = $_POST['category'];
    $result = mysqli_query($connection,"UPDATE categories SET category_name = '$category' WHERE category_id = $id");
    if($result){
        header("location:/admin/kategoriler");
    }else{
        echo '<div class="alert alert-danger">Kategori güncelleme hatası!</div><br>';
        echo mysqli_error($connection);
    }   
}
?>

<a href="/admin/" class="btn btn-info">Geri</a>
<a href="/admin/kategoriler" class="btn btn-success">Kategoriler</a>
<br>
<div class="row" style="margin-bottom:50px;">
<div class="col-md-5">
<?php
    if(isset($_GET["id"])){
        $id = $_GET["id"];
        $result = mysqli_query($connection,"SELECT * FROM categories WHERE category_id = $id");
        $row = mysqli_fetch_array($result,MYSQLI_ASSOC);
        if(mysqli_num_rows($result)==1){
            $category_name = $row["category_name"];
            echo'
            <form action="/admin/kategoriguncelle?id='.$id.'" method="post" enctype = "multipart/form-data">
            <dt><label for="title">Kategori:</label>
            <dd><input class="form-control" id="category" name="category" type="text" value="'.$category_name.'">
            </dd>  
            <button type="submit" class="btn btn-success">Kaydet</button>
            </form>';
        }
        else{
            header("location:/admin/kategoriler");
        }
    }
?>
    </div>
    </div>
    </div>
</div>

<?php require('adminIncludes/footer.php'); ?>