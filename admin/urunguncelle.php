<?php require('adminIncludes/header.php'); ?>
<h3>Ürün Güncelle</h3>
<?php
include('adminIncludes/config.php');

if($_POST){
    $id = $_GET["id"];
    $title = $_POST["title"];
    $subtitle = $_POST["subtitle"];
    $brand = $_POST["brand"];
    $model = $_POST["model"];
    $product_detail = $_POST["product_detail"];
    $price = $_POST["price"];
    $stock_amount = $_POST["stock_amount"];
    $result = mysqli_query($connection,"UPDATE products SET title = '$title', subtitle = '$subtitle', brand = '$brand', model = '$model', product_detail = '$product_detail', price = '$price', stock_amount = '$stock_amount' WHERE product_id = $id");
    if($result){
        header("location:/admin/urunler");
    }else{
        echo '<div class="alert alert-danger">Ürün güncelleme hatası!</div><br>';
        echo mysqli_error($connection);
    }
}
?>
<a href="/admin/" class="btn btn-info">Geri</a>
<a href="/admin/urunler" class="btn btn-success">Ürünler</a>
<br>
<div class="row" style="margin-bottom:50px;">
<div class="col-md-5">

<?php
if(isset($_GET["id"])){
    $id = $_GET["id"];
    $result = mysqli_query($connection,"SELECT * FROM products WHERE product_id = $id");
    $row = mysqli_fetch_array($result,MYSQLI_ASSOC);
    if(mysqli_num_rows($result)==1){
        $title = $row["title"];
        $subtitle = $row["subtitle"];
        $brand = $row["brand"];
        $model = $row["model"];
        $product_detail = $row["product_detail"];
        $price = $row["price"];
        $stock_amount = $row["stock_amount"];
        echo'
        <form action="/admin/urunguncelle?id='.$id.'" method="post" enctype = "multipart/form-data">
        <dt><label for="title">Başlık:</label>
        <dd><input class="form-control" id="title" name="title" type="text" value="'.$title.'">
        </dd>  
        <dt><label for="subtitle">Alt Başlık:</label>
        <dd><input class="form-control" id="subtitle" name="subtitle" type="text" value="'.$subtitle.'">
        </dd>
        <dt><label for="brand">Marka:</label>
        <dd><input class="form-control" id="brand" name="brand" type="text" value="'.$brand.'">
        </dd>
        <dt><label for="model">Model:</label>
        <dd><input class="form-control" id="model" name="model" type="text" value="'.$model.'">
        </dd>    
        <dt><label for="product_detail">Ürün Detayı:</label>
        <dd><textarea class="form-control" id="product_detail" name="product_detail">'.$product_detail.'</textarea>
        </dd> 
        <dt><label for="price">Ürün Fiyatı:</label>
        <dd><input class="form-control" id="price" name="price" type="text" value="'.$price.'">  
        </dd>
        <dt><label for="stock_amount">Stok Girdisi:</label>
        <dd><input class="form-control" id="stock_amount" name="stock_amount" type="text" value="'.$stock_amount.'">
        </dd>
        <button type="submit" class="btn btn-success">Kaydet</button>
        </form>
    ';
    }else{
        header("location:/admin/urunler");
    }
}
?>
    </div>
    </div>
    </div>
</div>

<?php require('adminIncludes/footer.php'); ?>